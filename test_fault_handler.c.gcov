        -:    0:Source:src/backend/tests/unit/test_fault_handler.c
        -:    0:Graph:build_backend_tests/test_fault_handler-test_fault_handler.gcno
        -:    0:Data:build_backend_tests/test_fault_handler-test_fault_handler.gcda
        -:    0:Runs:1
        -:    1:#include "../../api/handlers/fault_handler.h"
        -:    2:#include "../../api/http_server.h"
        -:    3:#include <assert.h>
        -:    4:#include <string.h>
        -:    5:#include <stdio.h>
        -:    6:
function test_fault_get_all called 1 returned 100% blocks executed 75%
        1:    7:void test_fault_get_all() {
        1:    8:    HttpRequest req = {0};
        1:    9:    HttpResponse res = {0};
        -:   10:
        1:   11:    strcpy(req.method, "GET");
        1:   12:    strcpy(req.path, "/api/faults");
        -:   13:
        1:   14:    handle_fault_request(&req, &res);
call    0 returned 1
        -:   15:
       1*:   16:    assert(res.status_code == 200);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   17:    assert(strstr(res.body, "faults") != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:   18:}
        -:   19:
function test_fault_get_single called 1 returned 100% blocks executed 75%
        1:   20:void test_fault_get_single() {
        1:   21:    HttpRequest req = {0};
        1:   22:    HttpResponse res = {0};
        -:   23:
        1:   24:    strcpy(req.method, "GET");
        1:   25:    strcpy(req.path, "/api/faults/1");
        -:   26:
        1:   27:    handle_fault_request(&req, &res);
call    0 returned 1
        -:   28:
       1*:   29:    assert(res.status_code == 200);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   30:    assert(strstr(res.body, "CNC Machine") != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:   31:}
        -:   32:
function test_fault_post called 1 returned 100% blocks executed 80%
        1:   33:void test_fault_post() {
        1:   34:    HttpRequest req = {0};
        1:   35:    HttpResponse res = {0};
        -:   36:
        1:   37:    strcpy(req.method, "POST");
        -:   38:
        1:   39:    handle_fault_request(&req, &res);
call    0 returned 1
        -:   40:
       1*:   41:    assert(res.status_code == 201);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:   42:}
        -:   43:
function test_fault_put_ack called 1 returned 100% blocks executed 75%
        1:   44:void test_fault_put_ack() {
        1:   45:    HttpRequest req = {0};
        1:   46:    HttpResponse res = {0};
        -:   47:
        1:   48:    strcpy(req.method, "PUT");
        1:   49:    strcpy(req.path, "/api/faults/1/acknowledge");
        -:   50:
        1:   51:    handle_fault_request(&req, &res);
call    0 returned 1
        -:   52:
       1*:   53:    assert(res.status_code == 200);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   54:    assert(strstr(res.body, "acknowledged") != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:   55:}
        -:   56:
function test_fault_put_resolve called 1 returned 100% blocks executed 75%
        1:   57:void test_fault_put_resolve() {
        1:   58:    HttpRequest req = {0};
        1:   59:    HttpResponse res = {0};
        -:   60:
        1:   61:    strcpy(req.method, "PUT");
        1:   62:    strcpy(req.path, "/api/faults/1/resolve");
        -:   63:
        1:   64:    handle_fault_request(&req, &res);
call    0 returned 1
        -:   65:
       1*:   66:    assert(res.status_code == 200);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   67:    assert(strstr(res.body, "resolved") != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:   68:}
        -:   69:
function test_fault_invalid_method called 1 returned 100% blocks executed 80%
        1:   70:void test_fault_invalid_method() {
        1:   71:    HttpRequest req = {0};
        1:   72:    HttpResponse res = {0};
        -:   73:
        1:   74:    strcpy(req.method, "DELETE");
        -:   75:
        1:   76:    handle_fault_request(&req, &res);
call    0 returned 1
        -:   77:
       1*:   78:    assert(res.status_code == 405);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:   79:}
        -:   80:
function main called 1 returned 100% blocks executed 100%
        1:   81:int main() {
        1:   82:    test_fault_get_all();
call    0 returned 1
        1:   83:    test_fault_get_single();
call    0 returned 1
        1:   84:    test_fault_post();
call    0 returned 1
        1:   85:    test_fault_put_ack();
call    0 returned 1
        1:   86:    test_fault_put_resolve();
call    0 returned 1
        1:   87:    test_fault_invalid_method();
call    0 returned 1
        -:   88:
        1:   89:    printf("[PASS] Fault handler\n");
call    0 returned 1
        1:   90:    return 0;
        -:   91:}
