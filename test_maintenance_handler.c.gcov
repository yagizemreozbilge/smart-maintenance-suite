        -:    0:Source:src/backend/tests/unit/test_maintenance_handler.c
        -:    0:Graph:build_backend_tests/test_maintenance_handler-test_maintenance_handler.gcno
        -:    0:Data:build_backend_tests/test_maintenance_handler-test_maintenance_handler.gcda
        -:    0:Runs:1
        -:    1:#include "../../api/handlers/maintenance_handler.h"
        -:    2:#include "../../api/http_server.h"
        -:    3:
        -:    4:#include <assert.h>
        -:    5:#include <string.h>
        -:    6:#include <stdio.h>
        -:    7:#include <stdlib.h>
        -:    8:
function test_serialize_maintenance called 1 returned 100% blocks executed 75%
        1:    9:void test_serialize_maintenance() {
        1:   10:    char *json = serialize_maintenance_to_json();
call    0 returned 1
        -:   11:
       1*:   12:    assert(json != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   13:    assert(strstr(json, "Routine oil change") != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   14:    assert(strstr(json, "completed") != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        -:   15:
        1:   16:    free(json);
        -:   17:
        1:   18:    printf("[PASS] serialize_maintenance_to_json\n");
call    0 returned 1
        1:   19:}
        -:   20:
function test_handle_maintenance_get called 1 returned 100% blocks executed 75%
        1:   21:void test_handle_maintenance_get() {
        1:   22:    HttpRequest req = {0};
        1:   23:    HttpResponse res = {0};
        -:   24:
        1:   25:    strcpy(req.method, "GET");
        -:   26:
        1:   27:    handle_maintenance_request(&req, &res);
call    0 returned 1
        -:   28:
       1*:   29:    assert(res.status_code == 200);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   30:    assert(strcmp(res.content_type, "application/json") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   31:    assert(strstr(res.body, "Routine oil change") != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        -:   32:
        1:   33:    printf("[PASS] handle_maintenance_request GET\n");
call    0 returned 1
        1:   34:}
        -:   35:
function test_handle_maintenance_not_allowed called 1 returned 100% blocks executed 78%
        1:   36:void test_handle_maintenance_not_allowed() {
        1:   37:    HttpRequest req = {0};
        1:   38:    HttpResponse res = {0};
        -:   39:
        1:   40:    strcpy(req.method, "POST");  // GET dışında bir şey
        -:   41:
        1:   42:    handle_maintenance_request(&req, &res);
call    0 returned 1
        -:   43:
       1*:   44:    assert(res.status_code == 405);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   45:    assert(strstr(res.body, "Only GET supported") != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        -:   46:
        1:   47:    printf("[PASS] handle_maintenance_request 405\n");
call    0 returned 1
        1:   48:}
        -:   49:
function main called 1 returned 100% blocks executed 100%
        1:   50:int main() {
        1:   51:    test_serialize_maintenance();
call    0 returned 1
        1:   52:    test_handle_maintenance_get();
call    0 returned 1
        1:   53:    test_handle_maintenance_not_allowed();
call    0 returned 1
        1:   54:    return 0;
        -:   55:}
