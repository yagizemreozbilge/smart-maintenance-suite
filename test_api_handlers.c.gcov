        -:    0:Source:src/backend/tests/unit/test_api_handlers.c
        -:    0:Graph:C:\Users\yagiz\Desktop\Project\smart-maintenance-suite\build_backend_tests\test_api-test_api_handlers.gcno
        -:    0:Data:C:\Users\yagiz\Desktop\Project\smart-maintenance-suite\build_backend_tests\test_api-test_api_handlers.gcda
        -:    0:Runs:1
        -:    1:#include "../../api/http_server.h"
        -:    2:#include "../../api/router.h"
        -:    3:#include <stdio.h>
        -:    4:#include <assert.h>
        -:    5:#include <string.h>
        -:    6:
function test_http_request_struct called 1 returned 100% blocks executed 100%
        1:    7:void test_http_request_struct() {
        -:    8:  HttpRequest req;
        -:    9:  assert(sizeof(req.method) == 10);
        -:   10:  assert(sizeof(req.path) == 256);
        -:   11:  assert(sizeof(req.query_params) == 512);
        -:   12:  assert(sizeof(req.body) == 4096);
        1:   13:  printf("[PASS] HttpRequest struct: correct sizes\n");
call    0 returned 1
        1:   14:}
        -:   15:
function test_http_response_struct called 1 returned 100% blocks executed 100%
        1:   16:void test_http_response_struct() {
        -:   17:  HttpResponse res;
        -:   18:  assert(sizeof(res.content_type) == 64);
        -:   19:  assert(sizeof(res.body) == 8192);
        1:   20:  printf("[PASS] HttpResponse struct: correct sizes\n");
call    0 returned 1
        1:   21:}
        -:   22:
function test_request_initialization called 1 returned 100% blocks executed 75%
        1:   23:void test_request_initialization() {
        1:   24:  HttpRequest req = {0};
        1:   25:  strcpy(req.method, "GET");
        1:   26:  strcpy(req.path, "/api/machines");
       1*:   27:  assert(strcmp(req.method, "GET") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   28:  assert(strcmp(req.path, "/api/machines") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:   29:  printf("[PASS] HttpRequest: initialization\n");
call    0 returned 1
        1:   30:}
        -:   31:
function test_response_initialization called 1 returned 100% blocks executed 73%
        1:   32:void test_response_initialization() {
        1:   33:  HttpResponse res = {0};
        1:   34:  res.status_code = 200;
        1:   35:  strcpy(res.content_type, "application/json");
        1:   36:  strcpy(res.body, "{\"success\": true}");
       1*:   37:  assert(res.status_code == 200);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   38:  assert(strcmp(res.content_type, "application/json") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   39:  assert(strstr(res.body, "success") != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:   40:  printf("[PASS] HttpResponse: initialization\n");
call    0 returned 1
        1:   41:}
        -:   42:
function test_request_with_query_params called 1 returned 100% blocks executed 75%
        1:   43:void test_request_with_query_params() {
        1:   44:  HttpRequest req = {0};
        1:   45:  strcpy(req.method, "GET");
        1:   46:  strcpy(req.path, "/api/login");
        1:   47:  strcpy(req.query_params, "u=admin&p=admin123");
       1*:   48:  assert(strstr(req.query_params, "u=admin") != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   49:  assert(strstr(req.query_params, "p=admin123") != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:   50:  printf("[PASS] HttpRequest: query parameters\n");
call    0 returned 1
        1:   51:}
        -:   52:
function test_request_with_body called 1 returned 100% blocks executed 75%
        1:   53:void test_request_with_body() {
        1:   54:  HttpRequest req = {0};
        1:   55:  strcpy(req.method, "POST");
        1:   56:  strcpy(req.path, "/api/machines");
        1:   57:  strcpy(req.body, "{\"name\": \"New Machine\", \"status\": \"operational\"}");
       1*:   58:  assert(strcmp(req.method, "POST") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   59:  assert(strstr(req.body, "New Machine") != NULL);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:   60:  printf("[PASS] HttpRequest: POST with body\n");
call    0 returned 1
        1:   61:}
        -:   62:
function test_response_status_codes called 1 returned 100% blocks executed 70%
        1:   63:void test_response_status_codes() {
        1:   64:  HttpResponse res1 = {.status_code = 200};
        1:   65:  HttpResponse res2 = {.status_code = 201};
        1:   66:  HttpResponse res3 = {.status_code = 400};
        1:   67:  HttpResponse res4 = {.status_code = 401};
        1:   68:  HttpResponse res5 = {.status_code = 404};
        1:   69:  HttpResponse res6 = {.status_code = 500};
       1*:   70:  assert(res1.status_code == 200);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   71:  assert(res2.status_code == 201);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   72:  assert(res3.status_code == 400);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   73:  assert(res4.status_code == 401);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   74:  assert(res5.status_code == 404);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   75:  assert(res6.status_code == 500);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:   76:  printf("[PASS] HttpResponse: all status codes\n");
call    0 returned 1
        1:   77:}
        -:   78:
function test_response_content_types called 1 returned 100% blocks executed 73%
        1:   79:void test_response_content_types() {
        1:   80:  HttpResponse res1 = {0};
        1:   81:  strcpy(res1.content_type, "application/json");
        1:   82:  HttpResponse res2 = {0};
        1:   83:  strcpy(res2.content_type, "application/xml");
        1:   84:  HttpResponse res3 = {0};
        1:   85:  strcpy(res3.content_type, "text/csv");
       1*:   86:  assert(strcmp(res1.content_type, "application/json") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   87:  assert(strcmp(res2.content_type, "application/xml") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:   88:  assert(strcmp(res3.content_type, "text/csv") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:   89:  printf("[PASS] HttpResponse: content types\n");
call    0 returned 1
        1:   90:}
        -:   91:
function test_request_method_types called 1 returned 100% blocks executed 71%
        1:   92:void test_request_method_types() {
        1:   93:  HttpRequest req1 = {0};
        1:   94:  strcpy(req1.method, "GET");
        1:   95:  HttpRequest req2 = {0};
        1:   96:  strcpy(req2.method, "POST");
        1:   97:  HttpRequest req3 = {0};
        1:   98:  strcpy(req3.method, "PUT");
        1:   99:  HttpRequest req4 = {0};
        1:  100:  strcpy(req4.method, "DELETE");
        1:  101:  HttpRequest req5 = {0};
        1:  102:  strcpy(req5.method, "OPTIONS");
       1*:  103:  assert(strcmp(req1.method, "GET") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:  104:  assert(strcmp(req2.method, "POST") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:  105:  assert(strcmp(req3.method, "PUT") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:  106:  assert(strcmp(req4.method, "DELETE") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
       1*:  107:  assert(strcmp(req5.method, "OPTIONS") == 0);
branch  0 taken 0 (fallthrough)
branch  1 taken 1
call    2 never executed
        1:  108:  printf("[PASS] HttpRequest: all HTTP methods\n");
call    0 returned 1
        1:  109:}
        -:  110:
function main called 1 returned 100% blocks executed 100%
        1:  111:int main() {
        1:  112:  printf("=== API Handlers Unit Tests ===\n");
call    0 returned 1
        1:  113:  test_http_request_struct();
call    0 returned 1
        1:  114:  test_http_response_struct();
call    0 returned 1
        1:  115:  test_request_initialization();
call    0 returned 1
        1:  116:  test_response_initialization();
call    0 returned 1
        1:  117:  test_request_with_query_params();
call    0 returned 1
        1:  118:  test_request_with_body();
call    0 returned 1
        1:  119:  test_response_status_codes();
call    0 returned 1
        1:  120:  test_response_content_types();
call    0 returned 1
        1:  121:  test_request_method_types();
call    0 returned 1
        1:  122:  printf("\nâœ… All API Handler unit tests passed!\n");
call    0 returned 1
        1:  123:  return 0;
        -:  124:}
